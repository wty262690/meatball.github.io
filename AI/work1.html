<!DOCTYPE html>
<html lang="en">
	<head >
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="apple-touch-icon" sizes="180x180" href="../image/favicon_io/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="../image/favicon_io/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="../image/favicon_io/favicon-16x16.png">
	<title>Taiwan</title>
    <link href="./css/main.css" rel="stylesheet" type="text/css">
    <link href="./css/work1.css" rel="stylesheet" type="text/css">
	<link href="./css/loading.css" rel="stylesheet" type="text/css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script>
		var width, height, genheight ;
		var wordline = 1
		var drawspeed = 2, genspeed = 60;
		var drawposition = -drawspeed, genposition = 0;
		var alltext="", alltextline="", inputtext="";
		var keyword = "Taiwan";
		var imagepath = "./image/image";
		var img;
		my_function = null;
		var genindex=0, numofgen = 0;
		//var t=setInterval(MoveDrawPosition,500);
		var istyping = false;
		//var t=setInterval(InputWord,2000);
		//var t=setInterval(setgenposition, genspeed * 1000);
		function MoveDrawPosition(){
			drawposition -= drawspeed;
			document.getElementById("draw").style['background-position-y'] = drawposition + "px";
		}

		function InputWord(){
			document.getElementById("word-image").innerHTML = '<div class= "word centerparent child" id = "imagparent"><div class="word centerparent child" id="promtimg""></div></div><div class="word centerparent child" id = "prompt">' +"</div>";
			inputtext = "<div>" + alltextline[wordline-1]+ "</div>" + inputtext;
			typing(alltextline[wordline], document.getElementById("prompt"),100);
			document.getElementById("word-word").innerHTML = inputtext;
			img = document.getElementById("promtimg");
			img.style['background-image'] = "url("+ imagepath +keyword+"/"+(wordline)+".jpg)";
			img.addEventListener("load", (event) => {
				const { naturalWidth, naturalHeight, width, height } = img;
				if (naturalWidth > naturalHeight){
					img.style['height'] = "auto"
					img.style['width'] = "95%"
				}
				else{
					img.style['height'] = "100px"
					img.style['width'] = "auto"
				}
			});
			addwordline();
		}

		function addwordline(){
			wordline+=1;
			wordline = wordline % alltextline.length;
		}
		
		window.onload=function(){
			width = window.innerWidth;
			height = window.innerHeight;
			genheight = width*(58/100);
			genposition = genheight;
			readTextFile(keyword);
			numofgen = Math.floor((height / genheight )) +2; 
			genindex = numofgen;
			creategenchild()
			loading()
		}

		var onresize = function(e) {
			width = window.innerWidth;
			height = window.innerHeight;
			genheight = width*58/100;
		}
		window.addEventListener("resize", onresize);
		
		function creategenchild(){
			document.getElementById("generate").innerHTML = ""
			for (i = 0; i < numofgen; i++) {
				document.getElementById("generate").innerHTML += "<div class= 'generate gen-img child' id='gen-img"+i+"'> </div>";
			}
			//setgenposition()
			setimagegenchild()
		}

		function addgenchild(){	
			genindex = genindex+1;
			document.getElementById("generate").innerHTML += "<div class= 'generate gen-img child' id='gen-img"+i+"'> </div>";
			setimagegenchild()
		}
		
		function setimagegenchild(){
			gen = document.getElementsByClassName("gen-img")
			var i = 0;
			Array.from(gen).forEach((img) => {
				img.style['background-image'] = "url(./image/gen_"+keyword+"/"+(((i)% 30)+1)+".jpg)";
				i++;
			})
		}

		$().ready(function(){
			//jQuery function
			my_function = function(genposition )
			{
				$('#generate').animate({
					scrollTop: genposition
					}, genspeed * 1000, 'linear');
			}
		})

		function setgenposition(){
			gen = document.getElementsByClassName("gen-img")
			addgenchild()
			my_function(genposition);
			genposition += genheight;
		}

</script>
	<script src="./js/loading.js"></script>
	<script src="./js/main.js"></script>
	</head>
	<body>
	<div id = "loading">
		<div class = "centerparent" id = "divloading">
			<div class = "title" id = "loadingtitle"></div>
			<div class = "smalltitle" id = "loadingsmalltitle">humanâ€“computer interaction</div>
			<div id = "line"></div>
		</div>
	</div>
	<div class="draw" id="draw"></div>

    <div class="word" id="word">
		<div class="word child" id="word-image"><div class="word child" id="promtimg"></div></div>
		<div class="word child" id="word-word"></div>
    </div>

	<div class="generate" id="generate"></div>

    </body>